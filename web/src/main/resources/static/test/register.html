<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="css/register.css"/>
</head>
<body>
<canvas></canvas>
<div class="content">
    <div class="form sign-in">
        <h2>欢迎回来</h2>
        <label>
            <span>账号</span>
            <input type="email"/>
        </label>
        <label>
            <span>密码</span>
            <input type="password"/>
        </label>
        <p class="forgot-pass"><a href="javascript:">忘记密码？</a></p>
        <button type="button" class="submit">登 录</button>

    </div>
    <div class="sub-cont">
        <div class="img">
            <div class="img__text m--up">
                <h2>还未注册？</h2>
                <p>立即注册，发现大量机会！</p>
            </div>
            <div class="img__text m--in">
                <h2>已有帐号？</h2>
                <p>有帐号就登录吧，好久不见了！</p>
            </div>
            <div class="img__btn">
                <span class="m--up">注 册</span>
                <span class="m--in">登 录</span>
            </div>
        </div>
        <div class="form sign-up">
            <h2>立即注册</h2>
            <div id="errorMsg" style="color:red;text-align: center"></div>
            <!--    *******************注册部分***********************    -->
            <form  id="registerForm" action="">
                <label>
                    <span>电话(账号)</span><label id="ErrorTel"></label>
                    <input type="tel" id="tel" name="utel"/>
                </label>
                <label>
                    <span>密码</span>
                    <input type="password" id="password" name="upass"/>
                </label>
                <label>
                    <span>用户名</span>
                    <input type="text" id="username" name="uname"/>
                </label>
                <label>
                    <span>邮箱</span>
                    <input type="email" id="email" name="uemail"/>
                </label>


                <label>
                    <span>安全问题（你的母校）</span>
                    <input type="text" id="pro" name="upro"/>
                </label>
                <button type="submit" class="submit">注 册</button>
            </form>


        </div>
    </div>
</div>

</body>
<script src="js/cursor.js" type="text/javascript"></script>
<script src="js/register.js"></script>
<script src="js/jquery-3.3.1.js"></script>
<script>
    /*
        表单校验：
            1.用户名：单词字符，长度8到20位
            2.密码：单词字符，长度8到20位
            3.email：邮件格式
            4.用户名：非空
            5.手机号：手机号格式
            6.出生日期：非空
            7.验证码：非空
     */

    //校验用户账号(电话号码)
    //数字 11位


    function checkTel() {
        //1.获取账号的值
        var utel = $("#tel").val();
        //2.定义正则
        var reg_tel = /^1[3456789]\d{9}$/;
        //3.判断，给出提示
        var flag = reg_tel.test(utel);
        if (flag) {
            $("#ErrorTel").text("");
        } else {
            $("#ErrorTel").text("内容错误");
        }
        return flag;
    }

    //校验密码
    function checkPassword() {
    //1.获取密码值
        var password = $("#password").val();
        //2.定义正则
        var reg_password = /^\w{8,20}$/;
        //3.判断，给出提示信息
        var flag = reg_password.test(password);
        if(flag){
            //密码合法
            $("#password").css("border","");
        }else{
            //密码非法,加一个红色边框
            $("#password").css("border","1px solid red");
        }
        return flag;
    }

    //校验邮箱
    function checkEmail(){
        //1.获取邮箱
        var email = $("#email").val();
        //2.定义正则
        var reg_email = /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
        //3.判断
        var flag = reg_email.test(email);
        if(flag){
            $("#email").css("border","");
        }else{
            $("#email").css("border","1px solid red");
        }
        return flag;
    }

    function checkUsername() {
         //1.获取用户名
        var username = $("#username").val();
        //2.定义正则
		var reg_uanme = /^\S+$/;
        //3.判断
		var flag = reg_uanme.test(username);
        if (flag){
            $("#username").css("border","");
          
        }else{
            $("#username").css("border","1px solid red");
        }
		            return  flag;
		}

        function checkPro(){
            //获取问题答案
            var pro = $("#pro").val();
            //定义正则
            var reg_pro = /^\S+$/;
            //判断
            var flag =reg_pro.test(pro);
            if(flag){
                $("#pro").css("border","");
            }else{
                $("#pro").css("border","1px solid red");
            }

            return flag;
        }

        $(function () {
            $("#registerForm").submit(function () {
            //1.发送数据到服务器
                if (checkTel()&&checkPassword()&&checkUsername()&&checkPro()&&checkEmail()){
            //校验通过，发送ajax请求，提交表单数据
                    //$("url","参数","返回成功获取的数据 function")
                $.post("user/regist",$(this).serialize(),function (data) {
                    if (data){
                        //注册成功，跳转成功页面
                        location.href="index.html";
                    }else{
                        //注册失败,给errorMsg添加提示信息
                        $("#errorMsg").html(data.errorMsg);
                    }
                });

                }
                //2.不让页面跳转
                return false;
                //如果这个方法没有返回值，或者返回为true，则表单提交，如果返回为false，则表单不提交
            });

            //当某一个组件失去焦点是，调用对应的校验方法
            $("#tel").blur(checkTel);
            $("#tel").blur(function() {
                //1.获取账号的值
                var utel = $("#tel").val();
                //2.去服务端校验该用户名是否存在--ajax将用户名提交到服务器校验
                $.post("/user/checkTel",{tel:utel},function (data) {
                    if (data){
                        //存在相同电话
                        alert("存在相同电话")
                        /*$("#tel").css("border", "1px red solid");*/

                    }else {
                        return true;
                    }
                })
            });
            $("#username").blur(checkUsername);
            $("#password").blur(checkPassword);
            $("#email").blur(checkEmail);
            $("#pro").blur(checkPro);
        } )


    }


</script>

</html>
